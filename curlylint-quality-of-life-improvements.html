<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>Curlylint: Quality-of-life improvements - Thibaud’s blog</title>

  <link rel="stylesheet" href="/css/screen.css">

  
  <meta name="description" content="Curlylint v0.13.0 is out. It’s a relatively minor release, but comes with a few nice-to-haves for users, and a lot of behind-the-scenes project changes.">
  <meta name="author" content="Thibaud Colas"><link rel="canonical" href="https://www.curlylint.org/blog/quality-of-life-improvements">
  <link href="/favicon.ico" rel="shortcut icon">
  <link href="/atom.xml" rel="alternate" title="Thibaud’s blog" type="application/atom+xml">

  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:url" content="https://www.curlylint.org/blog/quality-of-life-improvements">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Thibaud’s blog">
  <meta name="twitter:site" content="@thibaud_colas">
  <meta name="twitter:creator" content="@thibaud_colas">
  <meta property="og:title" content="Curlylint: Quality-of-life improvements">
  <meta property="og:description" content="Curlylint v0.13.0 is out. It’s a relatively minor release, but comes with a few nice-to-haves for users, and a lot of behind-the-scenes project changes.">
  
  <meta name="twitter:label1" value="Reading time">
  <meta name="twitter:data1" value="Not too long">

  <link rel="meta" title="FOAF" type="application/rdf+xml" href="/foaf.rdf">

  
  <script>
    window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
    ga('create','UA-34692999-4','auto');ga('send','pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>


</head>

<body   >
  <header><hgroup>
  <h1><a href="/">Thibaud’s blog</a></h1>
  
    <h2>Notes, thoughts, and open-source software</h2>
  
</hgroup>

</header>
  <nav>  
<ul class="main-navigation">
  <li><a href="https://twitter.com/thibaud_colas">Twitter</a></li>
  <li><a href="https://github.com/thibaudcolas">GitHub</a></li>
  <li><a href="/resume" data-no-instant>Resume</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div role="main" id="main">
    <div id="content">
      <div class="blog-index">
<article class="hentry">
  
  <header>
    
      <a class="edit-link" aria-label="Edit this page on GitHub" href="https://github.com/thibaudcolas/thibaudcolas/edit/main/src/_posts/2021-04-25-curlylint-quality-of-life-improvements.md">Edit</a>
      <h1 class="entry-title">Curlylint: Quality-of-life improvements</h1>
    
    
      <p class="meta">
        









<time datetime="2021-04-25T09:22:49+00:00" pubdate data-updated="true">2021-04-25 09:22</time>
        
      </p>
    
  </header>


<div class="entry-content" data-no-instant><p>Curlylint v0.13.0 is out. It’s a relatively minor release, but comes with a few nice-to-haves for users, and a lot of behind-the-scenes project changes.</p>

<!-- more -->

<h2 id="modern-python-support">Modern Python support</h2>

<p>Curlylint now officially supports Python 3.9, and (tentatively) Python 3.10, based on the 6th alpha release. From now on, you can expect support for all Python versions <a href="https://devguide.python.org/#status-of-python-branches">actively supported by CPython maintainers</a>. In the future, this will also mean actively removing support for Python versions that reach their scheduled end-of-life.</p>

<h2 id="removed-extras-for-development-dependencies">Removed extras for development dependencies</h2>

<p>Python packaging is very messy. I’ve recently started using the <a href="https://python-poetry.org/">Poetry</a> package manager at work, primarily for the benefit of having lockfiles to pin transitive dependencies on application-style projects (a must, in my opinion). Here is an excerpt of what installing curlylint looks like in a <code class="language-plaintext highlighter-rouge">poetry.lock</code>:</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[[package]</span><span class="err">]</span>
<span class="py">name</span> <span class="p">=</span> <span class="s">"curlylint"</span>
<span class="py">version</span> <span class="p">=</span> <span class="s">"0.12.2"</span>
<span class="py">description</span> <span class="p">=</span> <span class="s">" Experimental HTML templates linting for Jinja, Nunjucks, Django templates, Twig, Liquid"</span>
<span class="py">category</span> <span class="p">=</span> <span class="s">"main"</span>
<span class="py">optional</span> <span class="p">=</span> <span class="s">false</span>
<span class="py">python-versions</span> <span class="p">=</span> <span class="s">"&gt;=3.6"</span>

<span class="nn">[package.dependencies]</span>
<span class="py">attrs</span> <span class="p">=</span> <span class="s">"&gt;=17.2.0"</span>
<span class="py">click</span> <span class="p">=</span> <span class="s">"&gt;=6.5"</span>
<span class="py">dataclasses</span> <span class="p">=</span> <span class="s">{version = "&gt;=0.6", markers = "python_version &lt; </span><span class="se">\"</span><span class="s">3.7</span><span class="se">\"</span><span class="s">"}
parsy = "1.1.0"</span>
<span class="py">pathspec</span> <span class="p">=</span> <span class="s">"&gt;=0.6,&lt;1"</span>
<span class="py">toml</span> <span class="p">=</span> <span class="s">"&gt;=0.9.4"</span>

<span class="nn">[package.extras]</span>
<span class="py">dev</span> <span class="p">=</span> <span class="s">["black (==19.10b0)", "flake8 (==3.8.4)", "mypy (==0.812)", "pytest (==6.2.2)", "coverage (==5.4)"]</span>
</code></pre></div></div>

<p>I find this last line very puzzling – there really should be no need for dependencies intended only for development to be visible in the published package. I don’t want curlylint’s development dependencies changing from release to release to cause noise in upgrade diffs, hence why the <code class="language-plaintext highlighter-rouge">dev</code> extra has been removed.</p>

<p>It’s worth saying Poetry has otherwise been a pleasure to work with, with only a few minor inconveniences like this one. I would happily recommend it to people wanting more out of their Python package management.</p>

<h2 id="new---template-tags-cli-flag">New <code class="language-plaintext highlighter-rouge">--template-tags</code> CLI flag</h2>

<p>As the <a href="https://www.curlylint.org/docs/command-line-usage#--template-tags"><code class="language-plaintext highlighter-rouge">--template-tags</code> documentation</a> now states, this makes Curlylint aware of custom tags used in templates, so the parser can understand they contain HTML content to go through.</p>

<p>This option was previously only available via a TOML configuration file, via the (now deprecated) <code class="language-plaintext highlighter-rouge">jinja-custom-elements-names</code> / <code class="language-plaintext highlighter-rouge">jinja_custom_elements_names</code> setting. The new setting works the same, but can also be set via CLI flags.</p>

<h2 id="behind-the-scenes-changes">Behind-the-scenes changes</h2>

<p>There really is only one I want to highlight – improvements to Curlylint’s test suite, which have resulted in a <a href="https://coveralls.io/github/thibaudcolas/curlylint?branch=main">14% increase in test coverage</a>. While test coverage percentages generally don’t mean much, in this case this means:</p>

<ul>
  <li>The command line interface now has unit tests. While relatively basic in the current iteration, they should be very easy to add to.</li>
  <li>The parser has more unit tests, and they are now in line with the rest of the test suite.</li>
</ul>

<p><a href="https://coveralls.io/github/thibaudcolas/curlylint"><img src="/images/blog/curlylint-quality-of-life-improvements/coverage-over-time.png" alt="Screen capture of the Coveralls coverage score over time as an area chart, from 59% in early March to 74% now" /></a></p>

<blockquote>
  <p><a href="https://coveralls.io/">Coveralls</a> shows coverage increasing from 59.39% in early March to 74% in late April.</p>
</blockquote>

<p>Having comprehensive unit tests really matters to me as a maintainer, and from now on it should be much more realistic to expect all changes to the project to come with corresponding unit tests.</p>

<h2 id="up-next">Up next</h2>

<p>There are a lot of <a href="https://github.com/thibaudcolas/curlylint/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3Aparser">parser bugs</a> I will now feel much more comfortable approaching, due to having a way to easily write tests for them.</p>

<p>Short-term, I want to make sure to get to all of the open pull request, hopefully fully clearing the backlog. I can see people are responding very well to Curlylint despite its experimental nature, and are eager to help making it more useful:</p>

<ul>
  <li><a href="https://github.com/thibaudcolas/curlylint/pull/53">#53 Optional HTML container parsing for if-else-endif type code</a></li>
  <li><a href="https://github.com/thibaudcolas/curlylint/pull/75">#75 Add test for unresolved missing alt attribute inside django block (#72)</a></li>
  <li><a href="https://github.com/thibaudcolas/curlylint/pull/76">#76 Use types_or directive for hook instead of files</a></li>
</ul>

<p>For me, the most immediate next step will be presenting Curlylint at <a href="https://us.pycon.org/2021/">PyCon US 2021</a>! I hope to get critical feedback on the tool, and am also working on an “online playground” version to try lint templates without installing anything, we should make it simpler for people to try out the linter.</p>
</div>



  <footer>
    <p class="meta">
      
<span class="byline author vcard">By <span class="fn">Thibaud Colas</span></span>

      









<time datetime="2021-04-25T09:22:49+00:00" pubdate data-updated="true">2021-04-25 09:22</time>
      

<span class="categories">
  
    
      <a class="category" href="/categories/curlylint/">Curlylint</a>,
    
      <a class="category" href="/categories/tools/">Tools</a>,
    
      <a class="category" href="/categories/python/">Python</a>
    
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2021-web-conferences-accepting-talks" title="Previous Post: 2021 web conferences accepting talks">&laquo; 2021 web conferences accepting talks</a>
      
      
        <a class="basic-alignment right" href="/pycon-us-2021-building-accessibility-into-open-source-projects" title="Next Post: PyCon US 2021: Building accessibility into open-source projects">PyCon US 2021: Building accessibility into open-source projects &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/adding-prettier-existing-project">Adding Prettier onto an existing project</a>
      </li>
    
      <li class="post">
        <a href="/wagtail-developer-jobs-where-to-look">Wagtail developer jobs: where to look</a>
      </li>
    
      <li class="post">
        <a href="/aria-invalid-true-with-aria-describedby">aria-invalid="true" with aria-describedby</a>
      </li>
    
      <li class="post">
        <a href="/2022-web-conferences">2022 web conferences</a>
      </li>
    
      <li class="post">
        <a href="/djangocon-us-2021-kontrasto-improving-accessibility-with-python">DjangoCon US 2021: Kontrasto – improving accessibility with Python</a>
      </li>
    
  </ul>
</section>

  
<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos" data-user="thibaudcolas" data-count="5">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/thibaudcolas">@thibaudcolas</a> on GitHub
  
  <script src="/javascripts/github.js"></script>
</section>


</aside>


    </div>
  </div>
  <footer><p>
  By <a href="" rel="author">Thibaud Colas</a> -
  Content available under <a class="license" rel="license" href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a> -
  <span class="credit">Hosted on <a href="https://pages.github.com/">GitHub Pages</a></span> -
  <a class="fork-link" href="https://github.com/thibaudcolas/thibaudcolas">View source</a>
</p>

</footer>
  

<script src="/javascripts/libs/instantclick.min.js" data-no-instant></script>
<script data-no-instant>InstantClick.init(50);</script>


</body>
</html>
